@model Embedded_Signatures.Models.CreatePrescriptionModel
@{
    ViewData["Title"] = "Prescription";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!DOCTYPE html>
<div>
    @using (@Html.BeginForm("Index", "Home", FormMethod.Post))
    {
        <div class="container" style="margin-top:30px">
            <div class="row">
                <div class="col-md-12">
                    <div class="row justify-content-center">
                        <div class="col-sm-6 mb-4">
                            <h1 class="text-md-center">Criação de prescrição</h1>
                            <h5 id="infoData" class="text-md-center">Informe os dados abaixo para começar:</h5>
                        </div>
                    </div>
                </div>
                <div id="form-hide">
                    <div class="form-group" align="center">
                        <div class="row-cols-4 mb-2">
                            <div class="col-lg-4">
                                @Html.TextBoxFor(m =>m.PatientName, new{ placeholder="Nome do paciente", @class= "form-control form-rounded transparent-input" })
                            </div>
                        </div>
                        <div class="row-cols-4 mb-5">
                            <div class="col-lg-4">
                                @Html.DropDownListFor(m =>m.MedicationName,new List<SelectListItem>{
                            new SelectListItem{Text ="Medication A", Value = "Medication A"},
                            new SelectListItem{Text ="Medication B", Value = "Medication B"},
                            new SelectListItem{Text ="Medication C", Value = "Medication C"}
                            }, new {@class= "select-wrapper form-select transparent-input"})
                            </div>
                        </div>
                        <div class="row-cols-4">
                            <div class="col-lg-4">
                                <input type="submit" value="Começar" placeholder="Começar" class="form-control btn btn-primary" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>
<div class=row-cols-auto>
    <div class="col-sm-12">
        <div id="embed-container" class="frame-container"></div>
    </div>
</div>
<div class="row-cols-4">
    <div class="col-lg-4">
        <input id="Sign" onclick="runAgain()" value="Nova prescrição" class="sign-btn btn btn-primary" type="submit" />
    </div>
</div>




@section Scripts {
<script>
    @if(ViewBag.embed != null){
        @:sign('@ViewBag.embed');
    }
    function sign(url) {
        hideButtons();
        var widget = new LacunaSignerWidget({enableRefusal : true});
        widget.render(url, 'embed-container');
        widget.on(widget.events.documentSigned, function(e) {
            alert('Document ' + e.id + ' signed');
        });
    }

    function hideButtons() {
        var infoData = document.getElementById("infoData");
        infoData.hidden = true;
        var formHide = document.getElementById("form-hide");
        formHide.hidden = true;
    }

    function runAgain(){
        @ViewBag.embed = null;
        window.location.reload(true);
    }

</script>




    }








